import{c as v,j as e,H as A,B as d,M as D}from"./index-D1umKIgS.js";import{r as n}from"./router-CgUf3kh0.js";import{C as S,a as C,b as M,c as I}from"./card-B-z3UqDt.js";import{I as L}from"./input-DmfUCTH1.js";import{S as O}from"./send-LMGbKd1V.js";import"./vendor-CM9vOon3.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],G=v("Camera",Y);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],K=v("FileText",q);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],H=v("Mic",J);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Z=v("Upload",W);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],X=v("User",Q);function ee({message:u}){const i=u.sender==="bot";return e.jsxs("div",{className:`flex gap-3 ${i?"":"flex-row-reverse"}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${i?"bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-400":"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400"}`,children:i?e.jsx(A,{className:"h-4 w-4"}):e.jsx(X,{className:"h-4 w-4"})}),e.jsxs("div",{className:`max-w-[80%] rounded-lg p-3 ${i?"bg-purple-50 dark:bg-purple-950 text-purple-900 dark:text-purple-100":"bg-blue-50 dark:bg-blue-950 text-blue-900 dark:text-blue-100"}`,children:[e.jsx("div",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:u.content}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:new Date(u.timestamp).toLocaleTimeString()})]})]})}const se="Shalom and welcome to this sacred space of comfort. I'm here to offer support, share wisdom about special souls, and help you process your feelings about those you love and miss. How are you feeling today? ðŸ’œ";function te(){const[u,i]=n.useState([{id:"1",content:se,sender:"bot",timestamp:new Date().toISOString()}]),[t,c]=n.useState(!1),[r,o]=n.useState({askedAboutRelationship:!1,userRelationship:"",context:[]});return{messages:u,sendMessage:async p=>{const j={id:Date.now().toString(),content:p,sender:"user",timestamp:new Date().toISOString()};i(a=>[...a,j]),c(!0);const m=[...r.context,p].slice(-5);try{const a=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:p,context:m.join(" | "),relationship:r.userRelationship})});if(a.ok){const l=await a.json(),y={id:(Date.now()+1).toString(),content:l.message,sender:"bot",timestamp:new Date().toISOString()};i(h=>[...h,y]),o(h=>({...h,context:m})),c(!1);return}}catch(a){console.error("API call failed, using fallback:",a)}await new Promise(a=>setTimeout(a,1500+Math.random()*1e3));let f=ae(p);const N={id:(Date.now()+1).toString(),content:f,sender:"bot",timestamp:new Date().toISOString()};i(a=>[...a,N]),o(a=>({...a,context:m})),c(!1)},isTyping:t}}function ae(u,i){const t=u.toLowerCase(),c={grief:["I understand you're going through such a difficult time. Your pain is real and valid, and it's okay to feel overwhelmed by grief. ðŸ’™","Grief is love with nowhere to go. What you're feeling shows the depth of your connection with your loved one. ðŸ’œ","The love between you and this special person is sacred and eternal. Even though they're no longer physically here, that love continues to live within you. âœ¨"],memory:["Honoring their memory means living the values they taught you. Every act of kindness you do is their legacy continuing through you. ðŸ•¯ï¸","The best way to honor a special soul is to become the person they believed you could be. They saw greatness in you. ðŸ’«","Light candles in their memory, give charity in their name, share stories about them. These keep their memory alive and elevate their soul. ðŸ•¯ï¸"],comfort:["You are not alone in this journey. There are people here who care about your healing, and their love surrounds you always. ðŸ¤—","Take your time with grief. There's no timeline for healing from such a profound loss. Be gentle with yourself. ðŸ’","Your tears honor their memory. In Jewish tradition, tears are prayers - and your prayers reach their soul. ðŸ™"],default:["I'm here to listen and offer comfort. Your feelings are completely valid. ðŸ’œ","Would you like to share a memory? Sometimes talking about beautiful moments can bring both tears and healing. âœ¨","The connection between souls transcends physical boundaries. Your love for them continues forever. ðŸ’™"]};let r="default";t.includes("grief")||t.includes("struggling")||t.includes("pain")||t.includes("hurt")?r="grief":t.includes("memory")||t.includes("honor")||t.includes("remember")?r="memory":(t.includes("comfort")||t.includes("help")||t.includes("support"))&&(r="comfort");const o=c[r];return o[Math.floor(Math.random()*o.length)]}function de(){const{messages:u,sendMessage:i,isTyping:t}=te(),[c,r]=n.useState(""),[o,b]=n.useState([]),[p,j]=n.useState(!1),[m,f]=n.useState(null),[N,a]=n.useState(!1),[l,y]=n.useState(null),h=n.useRef(null),w=n.useRef(null),x=n.useRef(null);n.useEffect(()=>{var s;(s=h.current)==null||s.scrollIntoView({behavior:"smooth"})},[u]);const T=async()=>{c.trim()&&(await i(c),r(""))},E=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),T())},_=s=>{s.target.files&&b(Array.from(s.target.files))},$=async()=>{try{const s=await navigator.mediaDevices.getUserMedia({audio:!0}),g=new MediaRecorder(s);w.current=g;const R=[];g.ondataavailable=k=>{R.push(k.data)},g.onstop=()=>{const k=new Blob(R,{type:"audio/wav"});f(k),s.getTracks().forEach(F=>F.stop())},g.start(),j(!0)}catch(s){console.error("Error accessing microphone:",s),alert("Unable to access microphone. Please check permissions.")}},V=()=>{w.current&&(w.current.stop(),j(!1))},P=()=>{(o.length>0||m)&&(y({files:o,audio:m,description:c||"A memory I want to discuss"}),a(!0))},U=async()=>{if(!l)return;console.log("Saving memory:",l);const s=`I'd like to discuss ${l.description}${l.files.length>0?` (${l.files.length} file(s) attached)`:""}${l.audio?" (with voice recording)":""}`;await i(s),b([]),f(null),r(""),a(!1),y(null),x.current&&(x.current.value="")},z=()=>{a(!1),y(null)},B=()=>{b([]),f(null),x.current&&(x.current.value="")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-8 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 via-pink-500 to-purple-600 bg-clip-text text-transparent mb-2",children:"Comfort & Guidance"}),e.jsx("h2",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300 mb-3",children:"A caring space for your heart"}),e.jsx("p",{className:"text-lg text-purple-600 dark:text-purple-400 italic",children:"Share your feelings and find comfort in wisdom about special souls"})]}),e.jsxs(S,{className:"max-w-4xl mx-auto bg-gradient-to-br from-pink-50 to-purple-50 border-2 border-pink-200",children:[e.jsxs(C,{children:[e.jsxs(M,{className:"flex items-center gap-2 text-purple-800",children:[e.jsx(A,{className:"h-5 w-5 text-pink-500"}),"Share a Memory to Discuss"]}),e.jsx("p",{className:"text-sm text-purple-600",children:"Upload photos, videos, or record your voice to share precious memories and discuss them with our comfort companion"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-purple-600"}),e.jsx("label",{className:"text-sm font-medium text-purple-800",children:"Photos & Videos"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{ref:x,type:"file",accept:"image/*,video/*",multiple:!0,onChange:_,className:"hidden"}),e.jsxs(d,{onClick:()=>{var s;return(s=x.current)==null?void 0:s.click()},variant:"outline",className:"flex items-center gap-2 text-purple-700 border-purple-300 hover:bg-purple-50",children:[e.jsx(Z,{className:"h-4 w-4"}),"Choose Files"]}),o.length>0&&e.jsxs("span",{className:"text-sm text-purple-600",children:[o.length," file",o.length>1?"s":""," selected"]})]}),o.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map((s,g)=>e.jsx("div",{className:"bg-purple-100 px-3 py-1 rounded-full text-xs text-purple-700",children:s.name},g))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-purple-600"}),e.jsx("label",{className:"text-sm font-medium text-purple-800",children:"Voice Recording"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[p?e.jsxs(d,{onClick:V,className:"flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"Stop Recording"]}):e.jsxs(d,{onClick:$,variant:"outline",className:"flex items-center gap-2 text-purple-700 border-purple-300 hover:bg-purple-50",children:[e.jsx(H,{className:"h-4 w-4"}),"Record Voice"]}),m&&!p&&e.jsx("span",{className:"text-sm text-purple-600",children:"Voice recording ready"})]})]}),(o.length>0||m)&&e.jsxs("div",{className:"flex gap-3 pt-2 border-t border-purple-200",children:[e.jsxs(d,{onClick:P,className:"flex items-center gap-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white",children:[e.jsx(D,{className:"h-4 w-4"}),"Save & Discuss This Memory"]}),e.jsx(d,{onClick:B,variant:"outline",className:"text-gray-600 border-gray-300 hover:bg-gray-50",children:"Clear All"})]})]})]}),N&&l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(S,{className:"max-w-md mx-4 bg-white",children:[e.jsx(C,{children:e.jsxs(M,{className:"flex items-center gap-2 text-purple-800",children:[e.jsx(K,{className:"h-5 w-5"}),"Save This Memory"]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"You're about to save and discuss this memory with our comfort companion:"}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-purple-800",children:l.description}),l.files.length>0&&e.jsxs("p",{className:"text-xs text-purple-600 mt-1",children:["ðŸ“¸ ",l.files.length," file",l.files.length>1?"s":""]}),l.audio&&e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"ðŸŽ¤ Voice recording included"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{onClick:U,className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white",children:"Save & Discuss"}),e.jsx(d,{onClick:z,variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(S,{className:"h-[600px] flex flex-col",children:[e.jsxs(C,{className:"border-b",children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-purple-600"}),"Comfort Companion"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"A gentle space to process grief and find comfort"})]}),e.jsx(I,{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("div",{className:"space-y-4",children:[u.map(s=>e.jsx(ee,{message:s},s.id)),t&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),"Comfort Companion is typing..."]}),e.jsx("div",{ref:h})]})}),e.jsxs("div",{className:"border-t p-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{value:c,onChange:s=>r(s.target.value),onKeyPress:E,placeholder:"Share what's on your heart...",className:"flex-1",disabled:t}),e.jsxs(d,{onClick:T,disabled:!c.trim()||t,className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"Send"]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>r("I'm struggling with losing my mother"),className:"text-xs",children:"I'm struggling with grief"}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>r("Tell me about special souls"),className:"text-xs",children:"Tell me about special souls"}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>r("How do I honor her memory?"),className:"text-xs",children:"How to honor her memory"})]})]})]})})]})}export{de as ChatPage};
